%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                       Main document style 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Importing user packages (librarys for different functions and commands) 
\usepackage[utf8]{inputenc}         % interprets charecters as if they comply to ASCII standards
\usepackage{todonotes}              % to do notes 
\usepackage{subfiles}               % add subfiles
\usepackage[T1]{fontenc}            % text font
\usepackage{lmodern}                % font
\usepackage{pdfpages, pdflscape}    % add pdf's 
\usepackage{gensymb, textcomp}      % add symbols
\usepackage{lastpage}               % get the last page number 
\usepackage{graphicx}               % add images 
\usepackage{tabularx}               % add tables 
\usepackage{mathtools}              % math
\usepackage{listings}               % add lists (code)
\usepackage{enumitem}               % options for enumerate
\usepackage{setspace}               % define size of space (infinite) 
\usepackage{xcolor}                 % colors
\usepackage{fancyhdr}               % to get fancy headers
\usepackage [background=black, arrow=red, text=white]{callouts}      % add callouts 
\usepackage{wrapfig}                % positioning figures
\usepackage{subcaption}             % position mulitple figures 
\usepackage{tikz}
\usepackage{upquote}
\usepackage{tikz}                   % text on top of images
\usepackage[newfloat]{minted}
\usepackage{svg}
\usepackage{amsmath}

\definecolor{white}{gray}{1}
\definecolor{black}{gray}{0}

\definecolor{gray97}{gray}{.97}
\definecolor{gray92}{gray}{.92}
\definecolor{gray90}{gray}{.90}
\definecolor{gray80}{gray}{.80}
\definecolor{gray75}{gray}{.75}
\definecolor{gray45}{gray}{.45}
\definecolor{gray30}{gray}{.30}
\definecolor{gray20}{gray}{.20}
\definecolor{gray10}{gray}{.10}
\definecolor{gray07}{gray}{.07}
\definecolor{gray05}{gray}{.05}
\definecolor{gray02}{gray}{.02}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\definecolor{darkgray}{rgb}{0.95,0.95,0.95}
\definecolor{darkred}{rgb}{0.6,0.0,0.0}
\definecolor{darkgreen}{rgb}{0,0.50,0}

\definecolor{orange}{rgb}{0.99,0.48,0.13}
\definecolor{grass}{rgb}{0.18,0.80,0.18}
\definecolor{pink}{rgb}{0.97,0.15,0.45}

\definecolor{lightred}{rgb}{1, 0.80, 0.82}
\definecolor{lightblue}{rgb}{0.73, 0.87, 0.98}
\definecolor{lightgreen}{rgb}{0.86,0.93,0.78}
\definecolor{lightgray}{rgb}{0.95,0.95,0.95}


% For listings

\definecolor{listing-background}{HTML}{f9f7f6}
\definecolor{listing-numbers}    {HTML} {24292e}
\definecolor{listing-text-color} {HTML} {24292e}

\definecolor{listing-keyword}    {HTML} {005cc5}
\definecolor{listing-keyword-2}  {HTML} {d73a49}
\definecolor{listing-keyword-3}  {HTML} {dc6109}
\definecolor{listing-keyword-4}  {HTML} {dc6109}
\definecolor{listing-keyword-5}  {HTML} {6f42c1}

\definecolor{listing-identifier} {HTML} {e36209}
\definecolor{listing-string}     {HTML} {d73a49}
\definecolor{listing-comment}    {HTML} {1f8235}


% For hyperref

\definecolor{url-color}   {HTML} {005cc5}
\definecolor{cite-color}  {HTML} {1f8235}
\definecolor{file-color}  {HTML} {24292e}


% For 'about' section

\definecolor{linkedin-blue}   {HTML} {0A66C2}
\definecolor{github-black}   {HTML} {0D1117}
\definecolor{telegram-blue}   {HTML} {2F91ED}
\definecolor{twitter-blue}   {HTML} {1D9BF0}
\definecolor{orcid-green}   {HTML} {8ab527}
\definecolor{email-red}   {HTML} {ff6363}

% CODE LISTINGS - MINTED

\usemintedstyle{colorful}
% Good options (for light themes): default, sas, solarized-light, pastie, colorful, bw
% solarized-light has not the best readability
% pastie and colorful may be buggy when using linebreaks and escapeinsides

% To get a list of all available stylesheets, see the online demo at the Pygments
% website or execute the following command on the command line:
% $ pygmentize -L styles


\setminted{bgcolor=listing-background,
           escapeinside=¢¢,
           tabsize=4,
           linenos,
           breaklines}
           
\newenvironment{code}{\captionsetup{type=listing}}{}
\SetupFloatingEnvironment{listing}{name=Codice}

% page settings
\setlength{\marginparwidth}{2cm}    % margins
\usepackage[a4paper,left=2.5cm,right=2.5cm,top=2.5cm,bottom=4cm]{geometry}                 % dimensions 
\setlength\parindent{0pt}
\setlength{\parskip}{1em}

\renewcommand{\contentsname}{Indice dei contenuti} % content table 

\setlength{\headheight}{35.372pt} % header hight

\cfoot\thepage % page number as footer

% creating base header 
\pagestyle{fancy}
\rhead{\includegraphics[width=1cm]{images/kubernetes.png}}

%define colors for links
\definecolor{ceruleanblue}{rgb}{0.16, 0.32, 0.75}
\definecolor{coolblack}{rgb}{0.0, 0.18, 0.39}


% clickable table of contents
\usepackage{hyperref}
\hypersetup{linktoc = all, colorlinks=true, linkcolor=coolblack, filecolor=magenta, urlcolor=ceruleanblue, citecolor=ceruleanblue}

% number of subsections in table of contents
\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}


% defining code types
% CSS
\lstdefinelanguage{CSS}{
  keywords={color,background-image:,margin,padding,font,weight,display,position,top,left,right,bottom,list,style,border,size,white,space,min,width, transition:, transform:, transition-property, transition-duration, transition-timing-function},	
  sensitive=true,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  alsoletter={:},
  alsodigit={-}
}

% JavaScript
\lstdefinelanguage{JavaScript}{
  morekeywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
  morecomment=[s]{/*}{*/},
  morecomment=[l]//,
  morestring=[b]",
  morestring=[b]'
}

\lstdefinelanguage{HTML5}{
  language=html,
  sensitive=true,	
  alsoletter={<>=-},	
  morecomment=[s]{<!-}{-->},
  tag=[s],
  otherkeywords={
  % General
  >,
  % Standard tags
	<!DOCTYPE,
  </html, <html, <head, <title, </title, <style, </style, <link, </head, <meta, />,
	% body
	</body, <body,
	% Divs
	</div, <div, </div>, 
	% Paragraphs
	</p, <p, </p>,
	% scripts
	</script, <script,
  % More tags...
  <canvas, /canvas>, <svg, <rect, <animateTransform, </rect>, </svg>, <video, <source, <iframe, </iframe>, </video>, <image, </image>, <header, </header, <article, </article, <h1, </h1, <h2, </h2
  },
  ndkeywords={
  % General
  =,
  % HTML attributes
  charset=, src=, id=, width=, height=, style=, type=, rel=, href=, class=, name=, content=, lang=,
  % SVG attributes
  fill=, attributeName=, begin=, dur=, from=, to=, poster=, controls=, x=, y=, repeatCount=, xlink:href=,
  % properties
  margin:, padding:, background-image:, border:, top:, left:, position:, width:, height:, margin-top:, margin-bottom:, font-size:, line-height:, display:, font-family:, 
  background-color:,
	% CSS3 properties
  transform:, -moz-transform:, -webkit-transform:,
  animation:, -webkit-animation:,
  transition:,  transition-duration:, transition-property:, transition-timing-function:,
  }
}

\lstdefinestyle{htmlcssjs} {%
  % General design
%  backgroundcolor=\color{editorGray},
  basicstyle={\footnotesize\ttfamily},   
  frame=b,
  % line-numbers
  xleftmargin={0.75cm},
  numbers=left,
  stepnumber=1,
  firstnumber=1,
  numberfirstline=true,	
  % Code design
  identifierstyle=\color{black},
  keywordstyle=\color{blue}\bfseries,
  ndkeywordstyle=\color{editorGreen}\bfseries,
  stringstyle=\color{editorOcher}\ttfamily,
  commentstyle=\color{brown}\ttfamily,
  % Code
  language=HTML5,
  alsolanguage=JavaScript,
  alsodigit={.:;},	
  tabsize=2,
  showtabs=false,
  showspaces=false,
  showstringspaces=false,
  extendedchars=true,
  breaklines=true,
  % German umlauts
  literate=%
  {Ö}{{\"O}}1
  {Ä}{{\"A}}1
  {Ü}{{\"U}}1
  {ß}{{\ss}}1
  {ü}{{\"u}}1
  {ä}{{\"a}}1
  {ö}{{\"o}}1
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                   Command for the first page 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand*\FirstPage{
\thispagestyle{empty}
% placing a pdf as background and adding text on top
\includepdf[pages=1,picturecommand*={ 
                % selecting placement, font size and text type
                \put(130,630){\fontsize{28}{28}\selectfont{\textsc{\textbf{Kubernetes Observability}}}}
                \put(130,590){\fontsize{28}{28}\selectfont{\textsc{\textbf{\& Detection Engineering}}}}
                \put(130,200){\fontsize{28}{28}\selectfont{\Large{Corso di \textbf{Penetration Testing \& Ethical Hacking}}}}
                \put(130,180){\fontsize{28}{28}\selectfont{\Large{\textbf{Prof. Arcangelo Castiglione, a.a. 2023/2024}}}}
                \put(130,140){\fontsize{28}{28}\selectfont{\Large{Un'analisi a cura di \textbf{Antonio Gravino}}}}
                \put(132,115){\fontsize{22}{22}\selectfont{
                \hspace{-3mm}\Large{\href{https://github.com/antoniogrv/kube-observe/}{github.com/antoniogrv/kube-observe}}}}
                }]{images/frontpage.pdf}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                   Command for the second page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand*\SecondPage{
\thispagestyle{fancy}

% creating base header 
\rhead{\includegraphics[width=3.2cm]{images/kubernetes.png}}

% section header
\lhead{Prosjektoppgave Vår 2020}

% recreating the table from the given Word-report-template
\begin{table}[ht]
\setlength\extrarowheight{5pt}
    
    % first row
    \begin{tabularx}{\textwidth}{|X|}
        \hline
        \textbf{KANDIDATER (etternavn, fornavn):} \newpara
        Navn
    \end{tabularx}
    
    % second row
    \begin{tabularx}{\textwidth}{|p{1,4cm}|p{2,4cm}|p{4,4cm}|p{4,2cm}|p{2,25cm}|}
    \hline
    \textbf{DATO:} & \textbf{FAGKODE:} & \textbf{GRUPPE (navn/nr):} & \multicolumn{1}{c|}{\textbf{SIDER/BILAG:}} & \textbf{BIBL. NR:}\\
    30.04.20 & TST101 & \multicolumn{1}{c|}{Team Pro / Gruppe 16} & \multicolumn{1}{c|}{\pageref{LastPage} / 8} & N/A \\ 
    \hline
    \end{tabularx}
    
    % third row
    \begin{tabularx}{\textwidth}{|X|}
        \textbf{FAGLÆRER(E):} \\
        Navn \\
        \hline
    \end{tabularx}
    
    % forth row
    \begin{tabularx}{\textwidth}{|X|}
        \textbf{TITTEL:} \\
        Tittel \\
        \hline
    \end{tabularx}
    
    %fifth row
    \begin{tabularx}{\textwidth}{|X|}
        \addSammendrag \\ % new command to at the text file from sections (more orginised to write this way)
        \hline
    \end{tabularx}
\end{table}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                       New Commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%creating paragraphs --> \newpara
\newcommand{\newpara}{\vskip 2mm}

%add pdf's --> \addpdf
\newcommand*\addpdf[1]{
\includepdf[pages=-]{#1}}

%add pdf's in landscape --> \addpdflandscape
\newcommand*\addpdflscape[1]{
\begin{landscape}
\newgeometry{margin=0cm}
\includepdf[pages=-,angle=90]{#1}
\end{landscape}} 

%add conclusion (used in second-page table) --> \addSammendrag
\newcommand*\addSammendrag{
\subfile{sections/00_sammendrag.tex}}

%add sections with 4 numbers --> \paragraph
\usepackage{titlesec}
\setcounter{secnumdepth}{4}
\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
